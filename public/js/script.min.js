function hasClass(e,t){return!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function removeClass(e,t){if(e&&hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=" "+e.className.replace(n,"")+" "}}function addClass(e,t){e&&!hasClass(e,t)&&(e.className+="  "+t+"  ")}function forEachNl(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}function filterNl(e,t){for(var n=[],a=0;a<e.length;a++)t(e[a],a)&&n.push(e[a]);return n}function mapNl(e,t){for(var n=[],a=0;a<e.length;a++)n.push(t(e[a],a));return n}function reduceNl(e,t,n){for(var a=n,r=0;r<e.length;r++)a=t(a,e[r],r);return a}function everyNl(e,t){for(var n=0;n<e.length;n++)if(!t(e[n],n))return!1;return!0}function someNl(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n))return!0;return!1}function ajaxify(e,t){document.querySelectorAll(e).forEach(function(e){var n=e.attributes.href.value;e.addEventListener("click",function(e){e.preventDefault();var a=new XMLHttpRequest;a.onreadystatechange=function(){a.readyState==XMLHttpRequest.DONE&&(200==a.status?t(a.responseText):400==a.status?console.log("There was an error 400"):(console.log("something else other than 200 was returned"),console.log(a.responseText)))},a.open("GET",n,!0),a.send()},!1)})}function injectPartial(e,t,n){var a=document.querySelector(t);a.innerHTML="",currentPopup=(new DOMParser).parseFromString(n,"text/html");var r=currentPopup.documentElement.querySelector(e);a.appendChild(r)}function updateAgenda(){forEachNl(months,function(e,t){removeClass(e,"toLeft"),removeClass(e,"toRight"),removeClass(e,"currentMonth"),t<agendaIndex?addClass(e,"toLeft"):t>agendaIndex&&addClass(e,"toRight")}),addClass(months[agendaIndex],"currentMonth")}function updateTimeSelector(){forEachNl(document.querySelectorAll(".time-selector input"),function(e,t){t===agendaIndex&&(e.checked=!0)})}function filterAgenda(e,t){forEachNl(filterNl(document.querySelectorAll("article.event-ticket"),function(t){return hasClass(t,e)}),function(e){t?addClass(e,"filtered"):removeClass(e,"filtered")})}function toggleEmptyMonthMessage(){forEachNl(months,function(e){var t=e.querySelectorAll("article.event-ticket"),n=e.querySelector(".no-events-in-filter"),a=someNl(t,function(e){return!hasClass(e,"filtered")});!a&&t.length?(n.innerText="Aucun évènement ne correspond à votre recherche ce mois-ci.",addClass(n,"show")):a&&t.length&&removeClass(n,"show")})}function submitEnquiry(e){event.preventDefault(),addClass(contactForm,"loading"),ajaxPostMail(e,function(e){setTimeout(function(){notifyContactForm(e),removeClass(contactForm,"loading")},1e3)})}function ajaxPostMail(e,t){for(var n,a,r=e.querySelector("#action").value,o=new XMLHttpRequest,l=[],s=0;s<e.elements.length;s++)n=encodeURIComponent(e.elements[s].name),a=encodeURIComponent(e.elements[s].value),l.push(n+"="+a);l.push(encodeURIComponent("ajax")+"="+encodeURIComponent(!0)),l=l.join("&"),o.onreadystatechange=function(){4===o.readyState&&t(200===o.status?JSON.parse(o.responseText):["failure"])},o.open("POST",r,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.send(l)}function notifyContactForm(e){var t=document.querySelector(".result-box"),n=contactForm.querySelectorAll("input, textarea");n=[].slice.call(n,1),t.innerHTML="",e.forEach(function(e){var a=document.createElement("p");a.innerHTML=resultMessages[e],addClass(a,"result-message"),"missingFields"===e||"invalidEmail"===e||"invalidPhone"===e||"invalidCharacters"===e?addClass(a,"error"):addClass(a,e),t.appendChild(a),"missingFields"===e?forEachNl(n,function(e){""===e.value?addClass(e,"invalid"):removeClass(e,"invalid")}):"invalidEmail"===e&&"invalidCharacters"===e?addClass(contactForm.querySelector("#email"),"invalid"):"invalidPhone"===e?addClass(contactForm.querySelector("#phone"),"invalid"):forEachNl(n,function(t){removeClass(t,"invalid"),"success"===e&&(t.value="",t.focus(),t.blur())})})}ajaxify("article.event-ticket a",function(e){injectPartial("article.event",".popup-content",e),addClass(document.querySelector("body"),"popup-active")}),ajaxify("a.post",function(e){injectPartial("article.post",".popup-content",e),addClass(document.querySelector("body"),"popup-active")}),forEachNl(document.querySelectorAll(".close-popup, .popup-overlay"),function(e){e.addEventListener("click",function(e){removeClass(document.querySelector("body"),"popup-active")},!1)}),document.querySelector(".agenda")&&(addClass(document.querySelector(".agenda"),"interactive"),agendaIndex=0,months=document.querySelectorAll(".month"),document.querySelector(".controls .left").addEventListener("click",function(e){agendaIndex>0&&(agendaIndex--,updateAgenda(),updateTimeSelector())}),document.querySelector(".controls .right").addEventListener("click",function(e){agendaIndex<months.length-1&&(agendaIndex++,updateAgenda(),updateTimeSelector())}),forEachNl(document.querySelectorAll(".time-selector label"),function(e,t){e.addEventListener("click",function(e){agendaIndex=t,updateAgenda()})}),forEachNl(document.querySelectorAll(".filter label"),function(e,t){e.addEventListener("click",function(n){var a=document.querySelectorAll(".filter input")[t].checked;filterAgenda(e.getAttribute("for"),a),toggleEmptyMonthMessage()})}));var contactForm=document.querySelector("section.contact form"),resultMessages={success:"Votre message a été envoyé, merci.",invalidEmail:"Erreur&nbsp;: Veuillez entrer une adresse email valide.",invalidPhone:"Erreur&nbsp;: Veuillez entrer un numéro de téléphone valide.",missingFields:"Erreur&nbsp;: Des champs requis n'ont pas été remplis.",invalidCharacters:"Erreur&nbsp;: L’email contient des caractères invalides.",failure:"Erreur&nbsp;: Votre message n’a pas pu être envoyé, veuillez réessayer plus tard."};