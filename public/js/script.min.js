/* Add class raw javascript */

function hasClass(ele,cls) {
    return !!ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function removeClass(element, className) {
    if (element && hasClass(element,className)) {
        var reg = new RegExp('(\\s|^)'+className+'(\\s|$)');
        element.className = ' ' + element.className.replace(reg,'') + ' ';
    }
}

function addClass(element, className) {
    if (element && !hasClass(element,className)) {
        element.className += '  '+ className + '  ';
    }
}

// Higher-order functions for Nodelists and full browser support
// https://toddmotto.com/ditch-the-array-foreach-call-nodelist-hack/#recommendations
// These functions are taken from the allmighty http://eloquentjavascript.net/05_higher_order.html
// Also they have been adapted to support the index value
function forEachNl(array, action) {
  for (var i = 0; i < array.length; i++)
    action(array[i], i);
}

function filterNl(array, test) {
  var passed = [];
  for (var i = 0; i < array.length; i++) {
    if (test(array[i], i))
      passed.push(array[i]);
  }
  return passed;
}

function mapNl(array, transform) {
  var mapped = [];
  for (var i = 0; i < array.length; i++)
    mapped.push(transform(array[i], i));
  return mapped;
}

function reduceNl(array, combine, start) {
  var current = start;
  for (var i = 0; i < array.length; i++)
    current = combine(current, array[i], i);
  return current;
}

function everyNl(array, predicate) {
  for (var i = 0; i < array.length; i++) {
    if (!predicate(array[i], i))
      return false;
  }
  return true;
}

function someNl(array, predicate) {
  for (var i = 0; i < array.length; i++) {
    if (predicate(array[i], i))
      return true;
  }
  return false;
}


function ajaxify(linkEl, callback) {
	document.querySelectorAll(linkEl).forEach(function(el) {
		var url = el.attributes.href.value;
		el.addEventListener('click', function(event) {
			event.preventDefault();

			var xmlhttp = new XMLHttpRequest();

			xmlhttp.onreadystatechange = function() {
				if (xmlhttp.readyState == XMLHttpRequest.DONE ) {
					if (xmlhttp.status == 200) {
						callback(xmlhttp.responseText);
					} else if (xmlhttp.status == 400) {
						console.log('There was an error 400');
					} else {
						console.log('something else other than 200 was returned');
						console.log(xmlhttp.responseText);
					}
				}
			};

			xmlhttp.open("GET", url, true);
			xmlhttp.send();
		}, false);
	});
}

function injectPartial(partialEl, containerEl, response) {
	var container = document.querySelector(containerEl);
	container.innerHTML = "";
	currentPopup = new DOMParser().parseFromString(response, 'text/html');
	var content = currentPopup.documentElement.querySelector(partialEl);
	container.appendChild(content);
}

ajaxify('.event a', function(response){
	injectPartial('article.event', '.popup-content', response);
	addClass(document.querySelector('body'), 'popup-active');
});

ajaxify('a.post', function(response){
	injectPartial('article.post', '.popup-content', response);
	addClass(document.querySelector('body'), 'popup-active');
});

forEachNl(document.querySelectorAll('.close-popup, .popup-overlay'), function(el) {
	el.addEventListener('click', function(event) {
		removeClass(document.querySelector('body'), 'popup-active');
	}, false);
});

// addClass(document.querySelector('.agenda'), 'interactive');

// agendaIndex = 0;
// months = document.querySelectorAll('.month');

// document.querySelector('.controls .left').addEventListener('click', function(event) {
// 	if(agendaIndex > 0) {
// 		agendaIndex --;
// 		updateAgenda();
// 		updateTimeSelector();
// 	}
// });

// document.querySelector('.controls .right').addEventListener('click', function(event) {
// 	if(agendaIndex < months.length - 1) {
// 		agendaIndex ++;
// 		updateAgenda();
// 		updateTimeSelector();
// 	}
// });

// forEachNl(document.querySelectorAll('.time-selector label'), function(el, index) {
// 	el.addEventListener('click', function(event) {
// 		agendaIndex = index;
// 		updateAgenda();
// 	});
// });

// forEachNl(document.querySelectorAll('.filter label'), function(el, index) {
// 	el.addEventListener('click', function(event) {
// 		var checked = document.querySelectorAll('.filter input')[index].checked;
// 		filterAgenda(el.getAttribute('for'), checked);
// 		toggleEmptyMonthMessage();
// 	});
// });

// function updateAgenda() {
// 	forEachNl(months, function(el, index) {
// 		removeClass(el, 'toLeft');
// 		removeClass(el, 'toRight');
// 		removeClass(el, 'currentMonth');

// 		if(index < agendaIndex) {
// 			addClass(el, 'toLeft');
// 		} else if (index > agendaIndex) {
// 			addClass(el, 'toRight');
// 		}
// 	});

// 	addClass(months[agendaIndex], 'currentMonth');
// }

// function updateTimeSelector() {
// 	forEachNl(document.querySelectorAll('.time-selector input'), function(el, index){
// 		if(index === agendaIndex) {
// 			el.checked = true;
// 		}
// 	});
// }

// function filterAgenda(filter, toFilter) {
// 	var events = document.querySelectorAll('.event');

// 	var matchedEvents = filterNl(events, function(event){
// 		return hasClass(event, filter);
// 	});

// 	forEachNl(matchedEvents, function(event){
// 		if (toFilter) addClass(event, 'filtered');
// 		else removeClass(event, 'filtered');
// 	});
// }

// function toggleEmptyMonthMessage() {
// 	forEachNl(months, function(month){
// 		var eventsInMonth = month.querySelectorAll('.event');
// 		var alert = month.querySelector('.no-events-in-filter');

// 		var hasEvents = someNl(eventsInMonth, function(event){
// 			return !hasClass(event, 'filtered');
// 		});

// 		if (!hasEvents && eventsInMonth.length) {
// 			alert.innerText = 'Aucun évènement ne correspond à votre recherche ce mois-ci.';
// 			addClass(alert, 'show');
// 		} else if (hasEvents && eventsInMonth.length) {
// 			removeClass(alert, 'show');
// 		}
// 	});
// }
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxpdGllcy5qcyIsImFqYXguanMiLCJhZ2VuZGEuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDakVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBBZGQgY2xhc3MgcmF3IGphdmFzY3JpcHQgKi9cblxuZnVuY3Rpb24gaGFzQ2xhc3MoZWxlLGNscykge1xuICAgIHJldHVybiAhIWVsZS5jbGFzc05hbWUubWF0Y2gobmV3IFJlZ0V4cCgnKFxcXFxzfF4pJytjbHMrJyhcXFxcc3wkKScpKTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gICAgaWYgKGVsZW1lbnQgJiYgaGFzQ2xhc3MoZWxlbWVudCxjbGFzc05hbWUpKSB7XG4gICAgICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKCcoXFxcXHN8XiknK2NsYXNzTmFtZSsnKFxcXFxzfCQpJyk7XG4gICAgICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gJyAnICsgZWxlbWVudC5jbGFzc05hbWUucmVwbGFjZShyZWcsJycpICsgJyAnO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gYWRkQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gICAgaWYgKGVsZW1lbnQgJiYgIWhhc0NsYXNzKGVsZW1lbnQsY2xhc3NOYW1lKSkge1xuICAgICAgICBlbGVtZW50LmNsYXNzTmFtZSArPSAnICAnKyBjbGFzc05hbWUgKyAnICAnO1xuICAgIH1cbn1cblxuLy8gSGlnaGVyLW9yZGVyIGZ1bmN0aW9ucyBmb3IgTm9kZWxpc3RzIGFuZCBmdWxsIGJyb3dzZXIgc3VwcG9ydFxuLy8gaHR0cHM6Ly90b2RkbW90dG8uY29tL2RpdGNoLXRoZS1hcnJheS1mb3JlYWNoLWNhbGwtbm9kZWxpc3QtaGFjay8jcmVjb21tZW5kYXRpb25zXG4vLyBUaGVzZSBmdW5jdGlvbnMgYXJlIHRha2VuIGZyb20gdGhlIGFsbG1pZ2h0eSBodHRwOi8vZWxvcXVlbnRqYXZhc2NyaXB0Lm5ldC8wNV9oaWdoZXJfb3JkZXIuaHRtbFxuLy8gQWxzbyB0aGV5IGhhdmUgYmVlbiBhZGFwdGVkIHRvIHN1cHBvcnQgdGhlIGluZGV4IHZhbHVlXG5mdW5jdGlvbiBmb3JFYWNoTmwoYXJyYXksIGFjdGlvbikge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKVxuICAgIGFjdGlvbihhcnJheVtpXSwgaSk7XG59XG5cbmZ1bmN0aW9uIGZpbHRlck5sKGFycmF5LCB0ZXN0KSB7XG4gIHZhciBwYXNzZWQgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgIGlmICh0ZXN0KGFycmF5W2ldLCBpKSlcbiAgICAgIHBhc3NlZC5wdXNoKGFycmF5W2ldKTtcbiAgfVxuICByZXR1cm4gcGFzc2VkO1xufVxuXG5mdW5jdGlvbiBtYXBObChhcnJheSwgdHJhbnNmb3JtKSB7XG4gIHZhciBtYXBwZWQgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKylcbiAgICBtYXBwZWQucHVzaCh0cmFuc2Zvcm0oYXJyYXlbaV0sIGkpKTtcbiAgcmV0dXJuIG1hcHBlZDtcbn1cblxuZnVuY3Rpb24gcmVkdWNlTmwoYXJyYXksIGNvbWJpbmUsIHN0YXJ0KSB7XG4gIHZhciBjdXJyZW50ID0gc3RhcnQ7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspXG4gICAgY3VycmVudCA9IGNvbWJpbmUoY3VycmVudCwgYXJyYXlbaV0sIGkpO1xuICByZXR1cm4gY3VycmVudDtcbn1cblxuZnVuY3Rpb24gZXZlcnlObChhcnJheSwgcHJlZGljYXRlKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoIXByZWRpY2F0ZShhcnJheVtpXSwgaSkpXG4gICAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIHNvbWVObChhcnJheSwgcHJlZGljYXRlKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAocHJlZGljYXRlKGFycmF5W2ldLCBpKSlcbiAgICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn0iLCJcblxuZnVuY3Rpb24gYWpheGlmeShsaW5rRWwsIGNhbGxiYWNrKSB7XG5cdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwobGlua0VsKS5mb3JFYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0dmFyIHVybCA9IGVsLmF0dHJpYnV0ZXMuaHJlZi52YWx1ZTtcblx0XHRlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHR2YXIgeG1saHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXG5cdFx0XHR4bWxodHRwLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoeG1saHR0cC5yZWFkeVN0YXRlID09IFhNTEh0dHBSZXF1ZXN0LkRPTkUgKSB7XG5cdFx0XHRcdFx0aWYgKHhtbGh0dHAuc3RhdHVzID09IDIwMCkge1xuXHRcdFx0XHRcdFx0Y2FsbGJhY2soeG1saHR0cC5yZXNwb25zZVRleHQpO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoeG1saHR0cC5zdGF0dXMgPT0gNDAwKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnVGhlcmUgd2FzIGFuIGVycm9yIDQwMCcpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnc29tZXRoaW5nIGVsc2Ugb3RoZXIgdGhhbiAyMDAgd2FzIHJldHVybmVkJyk7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyh4bWxodHRwLnJlc3BvbnNlVGV4dCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0XHR4bWxodHRwLm9wZW4oXCJHRVRcIiwgdXJsLCB0cnVlKTtcblx0XHRcdHhtbGh0dHAuc2VuZCgpO1xuXHRcdH0sIGZhbHNlKTtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIGluamVjdFBhcnRpYWwocGFydGlhbEVsLCBjb250YWluZXJFbCwgcmVzcG9uc2UpIHtcblx0dmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyRWwpO1xuXHRjb250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcblx0Y3VycmVudFBvcHVwID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyhyZXNwb25zZSwgJ3RleHQvaHRtbCcpO1xuXHR2YXIgY29udGVudCA9IGN1cnJlbnRQb3B1cC5kb2N1bWVudEVsZW1lbnQucXVlcnlTZWxlY3RvcihwYXJ0aWFsRWwpO1xuXHRjb250YWluZXIuYXBwZW5kQ2hpbGQoY29udGVudCk7XG59XG5cbmFqYXhpZnkoJy5ldmVudCBhJywgZnVuY3Rpb24ocmVzcG9uc2Upe1xuXHRpbmplY3RQYXJ0aWFsKCdhcnRpY2xlLmV2ZW50JywgJy5wb3B1cC1jb250ZW50JywgcmVzcG9uc2UpO1xuXHRhZGRDbGFzcyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JyksICdwb3B1cC1hY3RpdmUnKTtcbn0pO1xuXG5hamF4aWZ5KCdhLnBvc3QnLCBmdW5jdGlvbihyZXNwb25zZSl7XG5cdGluamVjdFBhcnRpYWwoJ2FydGljbGUucG9zdCcsICcucG9wdXAtY29udGVudCcsIHJlc3BvbnNlKTtcblx0YWRkQ2xhc3MoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLCAncG9wdXAtYWN0aXZlJyk7XG59KTtcblxuZm9yRWFjaE5sKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jbG9zZS1wb3B1cCwgLnBvcHVwLW92ZXJsYXknKSwgZnVuY3Rpb24oZWwpIHtcblx0ZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuXHRcdHJlbW92ZUNsYXNzKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKSwgJ3BvcHVwLWFjdGl2ZScpO1xuXHR9LCBmYWxzZSk7XG59KTsiLCJcbi8vIGFkZENsYXNzKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZ2VuZGEnKSwgJ2ludGVyYWN0aXZlJyk7XG5cbi8vIGFnZW5kYUluZGV4ID0gMDtcbi8vIG1vbnRocyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb250aCcpO1xuXG4vLyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHMgLmxlZnQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4vLyBcdGlmKGFnZW5kYUluZGV4ID4gMCkge1xuLy8gXHRcdGFnZW5kYUluZGV4IC0tO1xuLy8gXHRcdHVwZGF0ZUFnZW5kYSgpO1xuLy8gXHRcdHVwZGF0ZVRpbWVTZWxlY3RvcigpO1xuLy8gXHR9XG4vLyB9KTtcblxuLy8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzIC5yaWdodCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbi8vIFx0aWYoYWdlbmRhSW5kZXggPCBtb250aHMubGVuZ3RoIC0gMSkge1xuLy8gXHRcdGFnZW5kYUluZGV4ICsrO1xuLy8gXHRcdHVwZGF0ZUFnZW5kYSgpO1xuLy8gXHRcdHVwZGF0ZVRpbWVTZWxlY3RvcigpO1xuLy8gXHR9XG4vLyB9KTtcblxuLy8gZm9yRWFjaE5sKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50aW1lLXNlbGVjdG9yIGxhYmVsJyksIGZ1bmN0aW9uKGVsLCBpbmRleCkge1xuLy8gXHRlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4vLyBcdFx0YWdlbmRhSW5kZXggPSBpbmRleDtcbi8vIFx0XHR1cGRhdGVBZ2VuZGEoKTtcbi8vIFx0fSk7XG4vLyB9KTtcblxuLy8gZm9yRWFjaE5sKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5maWx0ZXIgbGFiZWwnKSwgZnVuY3Rpb24oZWwsIGluZGV4KSB7XG4vLyBcdGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbi8vIFx0XHR2YXIgY2hlY2tlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5maWx0ZXIgaW5wdXQnKVtpbmRleF0uY2hlY2tlZDtcbi8vIFx0XHRmaWx0ZXJBZ2VuZGEoZWwuZ2V0QXR0cmlidXRlKCdmb3InKSwgY2hlY2tlZCk7XG4vLyBcdFx0dG9nZ2xlRW1wdHlNb250aE1lc3NhZ2UoKTtcbi8vIFx0fSk7XG4vLyB9KTtcblxuLy8gZnVuY3Rpb24gdXBkYXRlQWdlbmRhKCkge1xuLy8gXHRmb3JFYWNoTmwobW9udGhzLCBmdW5jdGlvbihlbCwgaW5kZXgpIHtcbi8vIFx0XHRyZW1vdmVDbGFzcyhlbCwgJ3RvTGVmdCcpO1xuLy8gXHRcdHJlbW92ZUNsYXNzKGVsLCAndG9SaWdodCcpO1xuLy8gXHRcdHJlbW92ZUNsYXNzKGVsLCAnY3VycmVudE1vbnRoJyk7XG5cbi8vIFx0XHRpZihpbmRleCA8IGFnZW5kYUluZGV4KSB7XG4vLyBcdFx0XHRhZGRDbGFzcyhlbCwgJ3RvTGVmdCcpO1xuLy8gXHRcdH0gZWxzZSBpZiAoaW5kZXggPiBhZ2VuZGFJbmRleCkge1xuLy8gXHRcdFx0YWRkQ2xhc3MoZWwsICd0b1JpZ2h0Jyk7XG4vLyBcdFx0fVxuLy8gXHR9KTtcblxuLy8gXHRhZGRDbGFzcyhtb250aHNbYWdlbmRhSW5kZXhdLCAnY3VycmVudE1vbnRoJyk7XG4vLyB9XG5cbi8vIGZ1bmN0aW9uIHVwZGF0ZVRpbWVTZWxlY3RvcigpIHtcbi8vIFx0Zm9yRWFjaE5sKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50aW1lLXNlbGVjdG9yIGlucHV0JyksIGZ1bmN0aW9uKGVsLCBpbmRleCl7XG4vLyBcdFx0aWYoaW5kZXggPT09IGFnZW5kYUluZGV4KSB7XG4vLyBcdFx0XHRlbC5jaGVja2VkID0gdHJ1ZTtcbi8vIFx0XHR9XG4vLyBcdH0pO1xuLy8gfVxuXG4vLyBmdW5jdGlvbiBmaWx0ZXJBZ2VuZGEoZmlsdGVyLCB0b0ZpbHRlcikge1xuLy8gXHR2YXIgZXZlbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmV2ZW50Jyk7XG5cbi8vIFx0dmFyIG1hdGNoZWRFdmVudHMgPSBmaWx0ZXJObChldmVudHMsIGZ1bmN0aW9uKGV2ZW50KXtcbi8vIFx0XHRyZXR1cm4gaGFzQ2xhc3MoZXZlbnQsIGZpbHRlcik7XG4vLyBcdH0pO1xuXG4vLyBcdGZvckVhY2hObChtYXRjaGVkRXZlbnRzLCBmdW5jdGlvbihldmVudCl7XG4vLyBcdFx0aWYgKHRvRmlsdGVyKSBhZGRDbGFzcyhldmVudCwgJ2ZpbHRlcmVkJyk7XG4vLyBcdFx0ZWxzZSByZW1vdmVDbGFzcyhldmVudCwgJ2ZpbHRlcmVkJyk7XG4vLyBcdH0pO1xuLy8gfVxuXG4vLyBmdW5jdGlvbiB0b2dnbGVFbXB0eU1vbnRoTWVzc2FnZSgpIHtcbi8vIFx0Zm9yRWFjaE5sKG1vbnRocywgZnVuY3Rpb24obW9udGgpe1xuLy8gXHRcdHZhciBldmVudHNJbk1vbnRoID0gbW9udGgucXVlcnlTZWxlY3RvckFsbCgnLmV2ZW50Jyk7XG4vLyBcdFx0dmFyIGFsZXJ0ID0gbW9udGgucXVlcnlTZWxlY3RvcignLm5vLWV2ZW50cy1pbi1maWx0ZXInKTtcblxuLy8gXHRcdHZhciBoYXNFdmVudHMgPSBzb21lTmwoZXZlbnRzSW5Nb250aCwgZnVuY3Rpb24oZXZlbnQpe1xuLy8gXHRcdFx0cmV0dXJuICFoYXNDbGFzcyhldmVudCwgJ2ZpbHRlcmVkJyk7XG4vLyBcdFx0fSk7XG5cbi8vIFx0XHRpZiAoIWhhc0V2ZW50cyAmJiBldmVudHNJbk1vbnRoLmxlbmd0aCkge1xuLy8gXHRcdFx0YWxlcnQuaW5uZXJUZXh0ID0gJ0F1Y3VuIMOpdsOobmVtZW50IG5lIGNvcnJlc3BvbmQgw6Agdm90cmUgcmVjaGVyY2hlIGNlIG1vaXMtY2kuJztcbi8vIFx0XHRcdGFkZENsYXNzKGFsZXJ0LCAnc2hvdycpO1xuLy8gXHRcdH0gZWxzZSBpZiAoaGFzRXZlbnRzICYmIGV2ZW50c0luTW9udGgubGVuZ3RoKSB7XG4vLyBcdFx0XHRyZW1vdmVDbGFzcyhhbGVydCwgJ3Nob3cnKTtcbi8vIFx0XHR9XG4vLyBcdH0pO1xuLy8gfSJdfQ==
